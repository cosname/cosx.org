---
title: 复合泊松过程模型的推广和在R语言环境下的随机模拟
date: '2012-08-12T10:00:39+00:00'
author: 叶钫
categories:
  - 数据分析
  - 随机过程
  - 风险精算
tags:
  - R语言
  - 复合泊松过程
  - 破产时刻
  - 破产概率
  - 随机模拟
slug: compound-poisson
forum_id: 418880
---

> 本文作者：叶钫，南京大学数学系
> 

# 0  引言

对保险人而言，资产和负债是影响保险人稳定经营至关重要的因素。资产和负债的差额称为盈余，简记作：

`$$U(t)=A(t)-L(t),t>0$$`

其中`$A(t)$`表示时刻`$t$`的资产，`$L(t)$`表示时刻`$t$`的负债，`$t=0$`时刻的盈余被称为初始盈余，简记为`$u$`，即`$U(0)=u$`。对这个初步的理论模型进行简化并根据实际情况设置一些假定情况，会得出很多不同的盈余过程模型，最经典的有Sparre Andersen的古典盈余过程模型：

`$$U(t)=u+ct-S(t);t\ge 0,u\ge 0,c>0$$`

这是一个以$u$为初值，以时间$t$为指标集的随机过程。其中$\{S(t),t>0\}$称为总理赔过程，满足：

`$$S(t)=\begin{cases}\\\ X_{1}+X_{2}+\cdots+X_{N_{(t)}} & ,N_{(t)}>0\\<br /> 0 & ,N_{(t)}=0\\\ \end{cases}$$`

`$N_{(t)}$`表示`$[0,t]$`内的总理赔次数，`$X_i$`表示`[0,t]$`内第`$i$`次理赔的金额。

根据这个古典盈余过程模型可以引出破产模型，在这个盈余过程模型中，一方面有连续不断的保费收入并以速度c进行积累，另一方面则是不断会有理赔需要支付，因此这是一个不断跳跃变化的过程。从保险人的角度来看，当然希望`$ct-S(t)$`恒大于0，否则就有可能出现`$U(t)<0$`的情况，这种情况可以定义为理论意义上的破产，以示与实际中的破产相区分，本文中后面出现的“破产”在没有特殊说明的情况下都是指这种理论情况。从研究保险人破产角度出发，可以把这个盈余过程模型看做是一个特殊的破产模型。

# 1  第一个推广的破产模型

在以上经典模型中，假设了保费收入速度是均匀的，而在实际中，在控制保费c的条件下，保单到达的时刻应该是一个离散的随机过程。根据现实经验，考虑一段很短的时间间隔中，认为保单到达的概率较小，而时间间隔数量可以非常之多且不清楚具体是多少，在概率论中一般用泊松分布来刻画这种概率分布，所以初步认为一段时间内保单到达的数量服从泊松分布。

同样地，由于理赔发生的概率远比保单发生的概率低，因此可以认为理赔发生的次数服从另一个独立的泊松分布。选取泊松分布来刻画这两个时间间隔的另一个原因是泊松分布具有一些优良的数学性质，便于分析和计算。根据泊松分布的性质，保单到达和理赔到达的时刻是两个独立的泊松过程。

另外，一般一款保险产品，它的保费往往是固定的，所以用固定的c来表示符合现实情况，而理赔金额往往根据发生事故的严重程度而定，可以认为每次理赔的金额服从一个独立的取值为非负的分布，根据经验，这个分布大致的要求是较高的概率对应较小的理赔额，较低的概率对应较大的理赔额，在常用的概率分布中，指数分布较好地满足这个特性，本文初步选用指数分布来刻画每次理赔额。

因此，第一个推广的破产模型可以表示为：

`$$U(t)=u+cM(t)-\sum_{i=1}^{N(t)}X_i;t\ge 0,u\ge 0,c>0$$`

其中保单到达时刻`$M(t)$`服从参数为`$\lambda_1$`的泊松过程，理赔发生时刻`$N(t)$`服从参数为`$\lambda_2$`的泊松过程，每次支付的保险费`$X_i$`服从参数为`$v$`的相互独立的指数分布。

<!--more-->

在这个模型中，保险人期望`$cM(t)-\sum_{i=1}^{N(t)}X_i$`能恒大于0，因此至少`$E(cM(t)-\sum_{i=1}^{N(t)}X_i)>0$`即`$c\lambda_1>\lambda_2/v$`，另外从经验来看，保险事故发生的概率一般不高，一次理赔的的金额应该远大于收到的保费，所以保单到达的速率应该远比理赔发生的速率大，否则这种产品就没有经营价值，保险人也将面临破产，所以`$\lambda_1\gg \lambda_2$`。

考虑以下一个具体的破产模型案例：

某一款保险产品，假设保单到达的速率为`$\lambda_1=10$`张/天，理赔发生的速率为`$\lambda_2=1$`次/天。假设每张保单价格c=120，理赔额服从参数为`$v=1/1000$`（以`$c\lambda_1=1.2\lambda_2/v$`设定）的指数分布。设定初始`$u=3000$`时，计算到第1000天为止发生破产的概率。

本文用R语言模拟了10000次，用时1625秒，大概不到半个小时的时间，时间还能接受。最终结果10000次中破产5293次，破产率大概53%。输出各阶段破产时刻频数和频率结果如下：
  
![sim1](https://uploads.cosx.org/2012/08/sim1-e1344696345207.png)

直方图为：
  
![hist1](https://uploads.cosx.org/2012/08/hist1.png)

由直方图可以非常明显地看出绝大部分破产时刻都在前100天，或者说从0开始的一小段时间内，在这之后的很长时间里，破产的频率急剧减少，可以认为破产的概率同样非常小。这对保险人来说，说明3000的初始盈余不够用，保险人需要准备更多准备金，才能抵抗初期的破产风险。

# 2 第二个继续推广的破产模型

在上一个破产模型中考虑了一款保险产品和对应理赔的问题，但现实中保险人往往同时经营着多种不同的保险产品，同样会有多种对应的理赔问题。基于这个想法，考虑将上一个模型进一步推广，就得到了以下模型：

`$$U(t) = u + \sum^{N(t)}_{i = 1}c_iM_i(t) – \sum^{N_i(t)}_{j = 1}\sum^{n}_{i = 1}X_{ij}, \quad t \geq 0; u \geq 0; c_i > 0$$`

将模型展开，可以表示为：

`$$U(t) = u + \sum^{N(t)}_{i = 1}c_iM_i(t) – (\sum^{N_1(t)}_{j = 1}X_{1j} + \sum^{N_2(t)}_{j = 1}X_{2j} + \cdots + \sum^{N_n(t)}_{j = 1}X_{nj})$$`

这个模型考虑有n款不同的保险产品，保费分别用`$c_i$`表示，第i款产品的保单到达时刻为`$M_i(t)$`。这样需要对应n款产品的理赔，假设第i款产品的理赔到达时刻为`$N_i(t)$`，对应的理赔额为`$X_{ij}$`，表示第i款产品第j次的理赔额。根据上一个模型的情况，这里假设`$M_i(t)$`是服从参数为`$\alpha_i$`的泊松过程，`$N_i(t)$`是服从参数为`$\beta_i$`的泊松过程，`$X_{ij}$`是服从参数为`$v_i$`的指数分布。同样地，根据每个保单的对应情况，要求满足`$c_i \alpha_i > \beta_i / v_i$`和`$\alpha_i > \beta_i$`。

考虑以下一个具体的破产模型案例：
  
某保险人同时经营了三款不同的保险产品，假设保单到达的速率为`$\alpha_i = 10$`每一单位时间（简化起见，不考虑实际单位，改用形式的一单位时间），`$\alpha_i = 20$`，`$\alpha_i = 30$`。理赔发生的速率为`$\beta_i = 1$`，`$\beta_i = 2$`，`$\beta_i = 3$`。`$X_{1j}$`服从参数`$v_1 = 1/1000$`的指数分布，假定`$v_2 = 1/1500$`，`$v_3 = 1/2000$`。以（20%预期收益率）的标准计算`$c_i$`的值。`$c_1 = 120$`，`$c_2 = 180$`，`$c_3 = 240$`。

鉴于上个模型的模拟经验，设置一个较大的初始盈余，初步设定`$u = 10$`万。但是模拟结果发现破产率百分之一百，继续提高初始盈余，发现在把准备金提高到100万的情况下结果仍然全部破产，这充分说明破产概率主要不是由初始盈余决定的。在事故发生的概率，即理赔到达强度参数不可控的情况下，保险人可调整的参数剩下保费和理赔额服从指数分布的参数。

首先通过同比例提高保费把预期收益率提高到40%，在设定初始盈余10万的情况下尝试模拟100次，发现仍然全部破产，直到把预期收益率提高到44%，破产率大概75%；把预期收益率提高到45%，破产概率大概70%；直到把预期收益率锁定在50%，100次模拟结果破产率大概33%，正好三分之一，这是一个比较理想的分界点。100次模拟时间76.49秒，时间稍长，如果模拟1万次，预计要花两个小时。暂时只模拟1000次来看下破产时刻的分布。
  
1000次模拟花时845秒，模拟结果破产概率27.7%，破产时刻的分布如下：
  
![sim2](https://uploads.cosx.org/2012/08/sim2.png)

破产时刻分布的直方图如下：
  
![hist2](https://uploads.cosx.org/2012/08/hist2.png)

直方图显示大部分破产时刻都在前200时刻，直方图大致形状酷似“钟形”的右半边。由此可联想到如果提高初始盈余，可能在一定程度上降低破产概率的同时，会使破产时刻的直方图整体右移，左半边也可能呈钟形分布，使整体服从类似正态分布的形状。
  
这里选取了初始盈余万，把预期收益率降到45%，模拟100次结果破产概率26%，与之前的结果接近。再选取初始盈余万，把预期收益率降到40%，模拟100次结果破产概率54%，验证了初始盈余和保费收入参数对破产比例的共同影响。两次结果的直方图如下：
  
![hist3](https://uploads.cosx.org/2012/08/hist3.png)

发现结果确实破产时刻整体右移，呈现钟形分布（第二幅图比较明显）。

对于另外一个角度，在保持原始保费额不变的情况下，还可以调整理赔额服从指数分布的参数，同样在初始盈余万，在保费收入不变的条件下，调整三个指数分布的参数，使预期收益率为30%，结果发现全未破产，说明调整指数分布的参数对破产率的影响效率跟保费不一样。把预期收益率调为20%，破产率立刻上升到81%，预期收益率为25%时，破产率又下降到18%，说明指数分布的参数对破产率波动的影响非常剧烈。

# 3 结论和建议

文中提出的推广模型由于其随机性和复杂性，想求解精确的解析解非常困难，所以通过随机模拟的方式来求渐近解是一种可行的好方法。从文中两个模型的模拟结果来看，首先，提高初始准备金的额度是很重要的，能大大降低保险人在初期破产的风险；其次，保险费对破产概率有显著的影响，保险人在制定保费的时候通过精确的计算和大量的模拟，能得到合适的保费额；最后，因为理赔额参数的变动对破产概率的影响最为剧烈，所以通过高额回报增加承保业务的行为对保险人是非常危险的，应谨慎对待。

# 4 模型的不足和其他有益探索

本文的模型建立在很大的理想化程度上，而在现实中，并不完全精确的服从指定的分布，所以将模型放到现实中应用的时候还需要进行改进和优化。另外本文只模拟了保单和理赔服从泊松过程的情况，还有可能是像带漂移的布朗运动那样更复杂的过程，理赔额也有可能服从对数正态分布、伽玛分布等情况，都没有做研究和讨论。还有一点，文中定义的破产跟现实的破产情况并不一致，现实情况要复杂的多，还受到其他更多因素的影响。

对于随机模拟来说，按照一般估计精度的理论，要达到较高精度，往往需要增加的模拟次数会呈指数增长，意味着模拟时间的成本会非常大。所以，设计一个既能现实模型要求，又能减少模拟次数与运行时间的算法非常重要。本文第二个模型的模拟设计正是从这个基本出发来实现的，不过在应对大容量的保单和高精度的要求时，还需要对设计思路进行优化，减少循环和判断次数，减少计算机搜索路径等。我觉得从泊松过程等常用分布的优良性质出发找到一个简化的等价刻画形式是一个可行的方向。

还有一点，随机模拟虽然都给出了定量的结果，但是都是离散的，而且中间间隔还很大。所以如果能通过大量模拟，取得破产概率关于保费收入和理赔支出的强度以及理赔支出额的多维样本数据，据此建立多元回归模型，可能会得到更多有益的结论，也能更好地应用于现实。

# 参考文献

[1]赵晓凡,牛明飞.广义多元风险模型破产时刻的随机模拟分析[J].中国科技论文,2008.
  
[2]孙立娟,顾岚.保险公司破产概率的估计及随机模拟[J].系统工程理论与实践,2000.
  
[3]陈新美.二元广义复合双Poisson风险模型下的破产概率[J].湘潭大学自然科学学报,2006.
  
[4]廖基定.经典风险模型破产概率及其局部渐近解[J].应用数学学报,2009.
  
[5]蒋云贵,柳思维.基于回归方程的流通企业破产风险模型[J].系统工程,2010.
  
[6]吴岚,王燕.风险理论[M].中国时政经济出版社,2006.
  
[7]肖枝洪,朱强.统计模拟及其R实现[M].武汉大学出版社,2010.
  
[8] [美]sheldon M.Ross.统计模拟(中文版·第4版)[M].人民邮电出版社,2007.
  
[9] [美]詹姆斯·埃文斯,戴维·奥尔森.模拟与风险分析[M].上海人民出版社,2001.
  
[10] [美] sheldon M.Ross.随机过程[M].中国统计出版社,1997.
  
[11]何书元.随机过程[M].北京大学出版社,2008.
  
[12]李皞.用R也能做精算—actuar包学习笔记

> 本文完整版（含源代码）请**[点击此处](https://uploads.cosx.org/2012/08/复合泊松破产模型的推广和R语言环境下的随机模拟.pdf)**。
